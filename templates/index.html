<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My App</title>
    <style>
        body { font-family: sans-serif; }
        .auth-container {
            position: absolute;
            top: 15px;
            right: 20px; /* Changed from left to right for common UI practice */
        }
        .auth-container a { margin-left: 10px; text-decoration: none; }
        .content { text-align: center; margin-top: 80px; }
        #userStatus { font-weight: bold; }
    </style>
</head>
<body>

    <div class="auth-container" id="authLinks">
        </div>

    <div class="content">
        <h1>Welcome to the Application!</h1>
        <p id="userStatus">Loading user status...</p>
        <p>Only logged-in users will have their actions saved to history.</p>
        
        <button id="actionButton">Perform an Action</button>
        <div id="responseMessage"></div>
    </div>

    <script>
        // This script runs when the page loads to check if the user is logged in
        window.addEventListener('load', async () => {
            const response = await fetch('/check-status');
            const data = await response.json();
            
            const authLinksDiv = document.getElementById('authLinks');
            const userStatusP = document.getElementById('userStatus');

            if (data.loggedIn) {
                // If user is logged in, show their name and a logout link
                userStatusP.textContent = `Logged in as: ${data.username}`;
                authLinksDiv.innerHTML = `<a href="/logout">Log Out</a>`;
            } else {
                // If user is a guest, show guest status and login/signup links
                userStatusP.textContent = 'Currently using as: Guest';
                authLinksDiv.innerHTML = `<a href="/login">Login</a> <a href="/signup">Sign Up</a>`;
            }
        });

        // This is the same logic as before for the action button
        document.getElementById('actionButton').addEventListener('click', () => {
            fetch('/save-action', { method: 'POST' })
            .then(res => res.json())
            .then(data => {
                document.getElementById('responseMessage').textContent = data.message;
            });
        });
    </script>

</body>
</html>